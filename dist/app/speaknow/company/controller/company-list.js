define(["connecta.speaknow","speaknow/company/service/company-service","portal/layout/service/notify"],function(speaknow){return speaknow.lazy.controller("CompanyListController",["$scope","CompanyService","notify","ngTableParams","sortBy",function($scope,CompanyService,notify,ngTableParams,sortBy){$scope.companies=null;$scope.search={name:""};$scope.tableParams=new ngTableParams({count:10,page:1,filter:$scope.search},{getData:function($defer,params){return CompanyService.list(params.url()).then(function(response){params.total(response.data.totalElements);var result=sortBy(response.data.content,"name");$defer.resolve(result)})},counts:[10,30,50,100]});$scope.getEmail=function(company){for(var i in company.mainContacts){if(company.mainContacts[i].type==="EMAIL"){return company.mainContacts[i].value}}};$scope.delete=function(id){CompanyService.delete(id).success(function(){notify.success("COMPANY.REMOVE_SUCCESS");$scope.tableParams.reload()})};$scope.modalParams={title:"Exclus√£o de empresa",text:"Deseja realmente excluir a empresa?",size:"sm",success:$scope.delete}}])});