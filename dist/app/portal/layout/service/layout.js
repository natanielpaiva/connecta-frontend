define(["connecta.portal"],function(portal){return portal.service("LayoutService",["$rootScope","$cookieStore","$menu","applications",function($rootScope,$cookieStore,$menu,applications){var layout=this;var MENU="connecta.portal.layout.menu";this.toggleSidebar=function(){$cookieStore.put(MENU,!$cookieStore.get(MENU));$rootScope.$broadcast("menu.mini",$cookieStore.get(MENU));return this};this.isMenuVisible=function(){return $cookieStore.get(MENU)};this.showAsFlat=function(flat){$rootScope.$broadcast("page.flat",flat);return this};this.showSidebar=function(val){$rootScope.$broadcast("sidebar.show",val);return this};this.showHeading=function(val){$rootScope.$broadcast("heading.show",val);return this};this.setFullscreen=function(fullscreen){$rootScope.$broadcast("page.fullscreen",fullscreen);return this};this.launchBrowserFullscreen=function(element){if(element.requestFullscreen){element.requestFullscreen()}else if(element.mozRequestFullScreen){element.mozRequestFullScreen()}else if(element.webkitRequestFullscreen){element.webkitRequestFullscreen()}else if(element.msRequestFullscreen){element.msRequestFullscreen()}};this.exitFullscreen=function(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}};this.isBrowserOnFullscreen=function(){var fullscreenEnabled=document.fullscreenEnabled||document.mozFullScreenEnabled||document.webkitFullscreenEnabled;if(fullscreenEnabled){var fullscreenElement=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;return!!fullscreenElement}return false};this.toggleBrowserFullscreen=function(){if(layout.isBrowserOnFullscreen()){layout.exitFullscreen()}else{layout.launchBrowserFullscreen(document.documentElement)}};this.moduleChanged=function(originModule,$originRoute,destModule,$destRoute){$menu.update();var configObject=null;if(angular.module(destModule)&&angular.module(destModule)._configKey&&applications[angular.module(destModule)._configKey]){configObject=applications[angular.module(destModule)._configKey]}$rootScope.$broadcast("layout.modulechange",{angularModule:destModule,route:$destRoute,config:configObject});$rootScope.$broadcast(destModule+".enter",$destRoute);if(originModule){$rootScope.$broadcast(originModule+".leave",$originRoute)}}}])});