<div class="row">
    <div class="col-xs-3 form-group" ng-if="edit===false">
        <label for="sourceOfdata" translate>ANALYSIS.SOURCE_OF_DATA</label>
        <select class="form-control" ng-model="databaseForm.selectSourceOfdata" ng-options="item.value as item.name for item in sourceOfdata" ng-change="getSourceOfdata()" >
            <option value="">Selecione</option>
        </select>
        <div ng-if="formulario.$dirty" ng-messages="formulario.driver.$error"
             ng-messages-include="portal-error-messages"></div>
    </div>
    
    <div class="col-xs-3 form-group" ng-if="edit === true">
        <label for="sourceOfdata" translate>ANALYSIS.SOURCE_OF_DATA</label>
        <input type="text" class="form-control" ng-model="databaseForm.type" disabled="disabled"> 
    </div>
    
    <div class="col-xs-3 form-group">
        <label for="dataInsertion" translate>ANALYSIS.DATA_INSERTION</label>
        <input type="date" name="dataInsertion" class="form-control" id="dataInsertion"
               ng-model="analysis.dataInsertion">
        <div ng-if="formulario.$dirty" ng-messages="formulario.txtPort.$error"
             ng-messages-include="portal-error-messages"></div>
    </div>
</div>


<div class="row" ng-if="databaseForm.selectSourceOfdata === 'table'">
   <div class="col-xs-6 form-group" ng-if="edit===false">
        <label for="table" translate>ANALYSIS.TABLE</label>
        <select class="form-control" name="table" ng-model="databaseForm.selectedTable"  ng-options="item as item.tableName for item in listTableDatasource">
            <option value="">Selecione</option>
        </select>
    </div>
    
    <div class="col-xs-6 form-group" ng-if="edit===true">
        <label for="table" translate>ANALYSIS.TABLE</label>
        <input type="text" class="form-control" ng-model="analysis.table" disabled="disabled"> 
    </div>
    
</div>
 
<div class="row" ng-if="databaseForm.selectSourceOfdata === 'sql'">
    <div class="col-xs-6 form-group">
        <label for="description" translate>ANALYSIS.CUSTOM_SQL</label>
        <textarea class="form-control" id="description" name="sql" rows="4"
                  ng-model="analysis.sql"></textarea>
        <button type="button" class="btn" ng-click="executSQL()">Aplicar</button>
    </div>
</div>


<div class="row margin-top-single" ng-if="responseDataBase">
    <div class="col-md-12">
        <table class="table table-striped table-hover" show-filter="true">
            <thead>
                <tr class="row">
                    <th ng-repeat="col in analysis.analysisColumns">
                        {{col.label}}
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="r in responseDataBase" class="row">
                    <td ng-repeat="col in analysis.analysisColumns" class="text-left">
                       {{ r[col.formula] }}
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
